
; /* Start:"a:4:{s:4:"full";s:90:"/local/templates/anylogic/components/itrade24/subscribe/subscribe/script.js?15276922192409";s:6:"source";s:75:"/local/templates/anylogic/components/itrade24/subscribe/subscribe/script.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
require(["jquery", "progress", "analytics", "tooltipster", "domReady!"], function($, progress, analytics, tooltipster) {
function validateEmail(email) {
  var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
  return re.test(email);
}
		$('#mc-embedded-subscribe-form').submit(function(e){

	    	e.preventDefault();

	    	var form = $(this);
	    	var smbButton = form.find("button");

	    	form.find('.input-error').removeClass('input-error');

			var msg = form.serialize();

	        smbButton.attr("disabled", true);

			var url = $(this).attr("action");
			url = url.replace("/post?u=", "/post-json?u=");
			url += "&c=?";

	        $.ajax({
	          type: 'GET',
			  dataType: 'json',
			  contentType: "application/json; charset=utf-8",
	          url: url,
	          data: msg,
	          success: function(data) {
	        	  progress.go(100);
	        	  smbButton.removeAttr("disabled");

	        	  if(data.result == 'success') {

	        		  smbButton.fadeOut(200, function() {
	        				$(form).hide();
							$('#get-subscribe').find("h3").hide();
							$('#get-subscribe').find(".input-element__message").text(data.msg);
	        				$('#get-subscribe').find(".input-element__message").fadeIn(200).css("display", "inline-block");
	        			});

					  analytics.trackEvent('all', form.data('target'), '');
	           		}
	          },
	          error:  function(xhr, str) {
	        	  smbButton.removeAttr("disabled");
	        	  progress.go(0);
            },
			beforeSend: function(){
				progress.go(50);

				/*checking by js, cause mailchimp send errors by stage*/
				var email = $('#mce-EMAIL');
				var country = $('#mce-MMERGE10 option:selected').val();
				if(email.val() == '' || !validateEmail(email.val())){
					$(email).parents('div.input-element:first').addClass('input-error');
					$(email).parents('div.input-element:first').find('.tooltip-error:first').tooltipster('content', 'Please enter a valid e-mail address');
				}
				if(country == ''){
					form.find('.select-element').attr('data-error', 'errCountry');
					form.find('.select-element').trigger("select-error", [{ msg: 'This field is required' }]);
				}

			}
	        });

	        return false;

	    });
});
/* End */
;; /* /local/templates/anylogic/components/itrade24/subscribe/subscribe/script.js?15276922192409*/
